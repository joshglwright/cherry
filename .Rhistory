smoking_history +
malignant,
family = binomial(link = 'logit'))
rsq(hosp_long_fit)
rsq(hosp_long_fit,adj = TRUE)
rsq(hosp_long_fit,adj = TRUE, type = 'v')
hosp_long_fit
rsq.lr(fitObj = hosplongfit)
long_stay = (kidney_hosp$hospitalization >=5))
long_stay = (kidney_hosp$hospitalization >=5)
long_stay
long_stay = (kidney_hosp$hospitalization >=5)
kidney_hosp2<-cbind(kidney_hosp,long_stay)
glm(formula = long_stay ~ age_at_nephrectomy +
gender +
body_mass_index +
surgery_type +
surgical_approach +
surgical_procedure +
clavien_surgical_complications +
estimated_blood_loss +
comorbidities__chronic_kidney_disease +
comorbidities__hemiplegia_from_stroke +
pathologic_size +
cytoreductive +
alcohol_use +
smoking_history +
malignant,
family = binomial(link = 'logit'),
data = kidney_hosp2)
long_stay_fit<-  glm(formula = long_stay ~ age_at_nephrectomy +
gender +
body_mass_index +
surgery_type +
surgical_approach +
surgical_procedure +
clavien_surgical_complications +
estimated_blood_loss +
comorbidities__chronic_kidney_disease +
comorbidities__hemiplegia_from_stroke +
pathologic_size +
cytoreductive +
alcohol_use +
smoking_history +
malignant,
family = binomial(link = 'logit'),
data = kidney_hosp2)
long_stay_fit
rsq(long_stay_fit)
hosp_days_fit<-  glm(formula = hospitalization ~ age_at_nephrectomy +
gender +
body_mass_index +
surgery_type +
surgical_approach +
surgical_procedure +
clavien_surgical_complications +
estimated_blood_loss +
comorbidities__chronic_kidney_disease +
comorbidities__hemiplegia_from_stroke +
pathologic_size +
cytoreductive +
alcohol_use +
smoking_history +
malignant,
family = poisson(link = 'log'),
data = kidney_hosp)
hosp_days_fit
rsq(hosp_days_fit)
?rsq
glm(formula = hospitalization ~ age_at_nephrectomy +
gender +
body_mass_index +
surgery_type +
surgical_approach +
surgical_procedure +
clavien_surgical_complications +
estimated_blood_loss +
comorbidities__chronic_kidney_disease +
comorbidities__hemiplegia_from_stroke +
pathologic_size +
cytoreductive +
alcohol_use +
smoking_history +
malignant,
family = quasipoisson(),
data = kidney_hosp)
hosp_days_fit_q<-glm(formula = hospitalization ~ age_at_nephrectomy +
gender +
body_mass_index +
surgery_type +
surgical_approach +
surgical_procedure +
clavien_surgical_complications +
estimated_blood_loss +
comorbidities__chronic_kidney_disease +
comorbidities__hemiplegia_from_stroke +
pathologic_size +
cytoreductive +
alcohol_use +
smoking_history +
malignant,
family = quasipoisson(),
data = kidney_hosp)
hosp_days_fit_q
summary(hosp_days_fit_q)
1/0.7077481
long_stay_fit_q<-  glm(formula = long_stay ~ age_at_nephrectomy +
gender +
body_mass_index +
surgery_type +
surgical_approach +
surgical_procedure +
clavien_surgical_complications +
estimated_blood_loss +
comorbidities__chronic_kidney_disease +
comorbidities__hemiplegia_from_stroke +
pathologic_size +
cytoreductive +
alcohol_use +
smoking_history +
malignant,
family = quasibinomial(link = 'logit'),
data = kidney_hosp2)
summary(long_stay_fit_q)
67.9/70
90-67.9
95-67.9
27.1/30
quantile(kidney_hosp$hospitalization)
quantile(kidney_hosp$hospitalization,seq(0,1,0.1))
23-5
22.1/30
rsq.n(hosp_days_fit)
rsq.n(hosp_days_fit_q)
rsq.n(long_stay_fit)
rsq.n(long_stay_fit_q)
rsq.lr(long_stay_fit_q)
rsq.lr(long_stay_fit)
hosp_days_fit_si<-  glm(formula = hospitalization ~ age_at_nephrectomy +
gender +
body_mass_index +
surgery_type *
surgical_approach *
surgical_procedure *
cytoreductive +
clavien_surgical_complications +
estimated_blood_loss +
comorbidities__chronic_kidney_disease +
comorbidities__hemiplegia_from_stroke +
pathologic_size +
cytoreductive +
alcohol_use +
smoking_history +
malignant,
family = poisson(link = 'log'),
data = kidney_hosp)
hosp_days_fit_si
summary(hosp_days_fit_si)
rsq.n(hosp_days_fit_si)
rsq.n(hosp_days_fit)
rsq.n(hosp_days_fit,adj = TRUE)
rsq.lr(hosp_days_fit,adj = TRUE)
rsq.lr(hosp_days_fit_si,adj = TRUE)
hosp_days_fit_si<-  glm(formula = hospitalization ~ age_at_nephrectomy *
gender *
body_mass_index +
surgery_type *
surgical_approach *
surgical_procedure *
cytoreductive +
clavien_surgical_complications *
estimated_blood_loss +
comorbidities__chronic_kidney_disease *
comorbidities__hemiplegia_from_stroke +
alcohol_use *
smoking_history +
pathologic_size *
malignant,
family = poisson(link = 'log'),
data = kidney_hosp)
summary(hosp_days_fit_si)
rsq.lr(hosp_days_fit_si)
rsq.lr(hosp_days_fit)
rsq.n(hosp_days_fit)
rsq.n(hosp_days_fit_si)
summary(hosp_days_fit)
hosp_days_fit_ind<-  glm(formula = hospitalization ~ age_at_nephrectomy +
gender +
body_mass_index +
surgery_type +
surgical_approach +
surgical_procedure +
clavien_surgical_complications +
estimated_blood_loss +
comorbidities__chronic_kidney_disease +
comorbidities__hemiplegia_from_stroke +
pathologic_size +
cytoreductive +
alcohol_use +
smoking_history +
malignant,
family = poisson(link = 'log'),
data = kidney_hosp)
hosp_days_fit_sur<-  glm(formula = hospitalization ~ age_at_nephrectomy +
gender +
body_mass_index +
surgery_type *
surgical_approach *
surgical_procedure *
cytoreductive +
clavien_surgical_complications +
estimated_blood_loss +
comorbidities__chronic_kidney_disease +
comorbidities__hemiplegia_from_stroke +
pathologic_size +
alcohol_use +
smoking_history +
malignant,
family = poisson(link = 'log'),
data = kidney_hosp)
hosp_days_fit_sat<-  glm(formula = hospitalization ~ age_at_nephrectomy *
gender *
body_mass_index +
surgery_type *
surgical_approach *
surgical_procedure *
cytoreductive +
clavien_surgical_complications *
estimated_blood_loss +
comorbidities__chronic_kidney_disease *
comorbidities__hemiplegia_from_stroke +
pathologic_size *
malignant +
alcohol_use *
smoking_history,
family = poisson(link = 'log'),
data = kidney_hosp)
rsq.n(hosp_days_fit_ind)
rsq.n(hosp_days_fit_sur)
rsq.n(hosp_days_fit_sat)
rsq.n(hosp_days_fit_ind, adj = TRUE)
rsq.lr(hosp_days_fit_ind, adj = TRUE)
rsq(hosp_days_fit_sur, adj = TRUE)
rsq(hosp_days_fit_sat, adj = TRUE)
rsq(hosp_days_fit_ind, adj = TRUE)
summary(hosp_days_fit_ind)
summary(hosp_days_fit_sat)
AIC(hosp_days_fit_ind)
AIC(hosp_days_fit_sur)
AIC(hosp_days_fit_sat)
hosp_days_fit_ind_q<-glm(formula = hospitalization ~ age_at_nephrectomy +
gender +
body_mass_index +
surgery_type +
surgical_approach +
surgical_procedure +
clavien_surgical_complications +
estimated_blood_loss +
comorbidities__chronic_kidney_disease +
comorbidities__hemiplegia_from_stroke +
pathologic_size +
cytoreductive +
alcohol_use +
smoking_history +
malignant,
family = quasipoisson(),
data = kidney_hosp)
hosp_days_fit_ind_q
summary(hosp_days_fit_ind_q)
summary(hosp_days_fit_ind_q)$theta
summary(hosp_days_fit_ind)
confint(hosp_days_fit_ind)
long_stay_fit_ind<-  glm(formula = long_stay ~ age_at_nephrectomy +
gender +
body_mass_index +
surgery_type +
surgical_approach +
surgical_procedure +
clavien_surgical_complications +
estimated_blood_loss +
comorbidities__chronic_kidney_disease +
comorbidities__hemiplegia_from_stroke +
pathologic_size +
cytoreductive +
alcohol_use +
smoking_history +
malignant,
family = binomial(link = 'logit'),
data = kidney_hosp2)
long_stay_fit_sur<-  glm(formula = long_stay ~ age_at_nephrectomy +
gender +
body_mass_index +
surgery_type *
surgical_approach *
surgical_procedure *
cytoreductive +
clavien_surgical_complications +
estimated_blood_loss +
comorbidities__chronic_kidney_disease +
comorbidities__hemiplegia_from_stroke +
pathologic_size +
alcohol_use +
smoking_history +
malignant,
family = binomial(link = 'logit'),
data = kidney_hosp2)
long_stay_fit_sat<-  glm(formula = long_stay ~ age_at_nephrectomy *
gender *
body_mass_index +
surgery_type *
surgical_approach *
surgical_procedure *
cytoreductive +
clavien_surgical_complications *
estimated_blood_loss +
comorbidities__chronic_kidney_disease *
comorbidities__hemiplegia_from_stroke +
alcohol_use *
smoking_history +
pathologic_size *
malignant,
family = binomial(link = 'logit'),
data = kidney_hosp2)
AIC(long_stay_fit_ind)
AIC(long_stay_fit_sur)
AIC(long_stay_fit_sat)
rsq(long_stay_fit_ind, adj = TRUE)
rsq(long_stay_fit_ind, adj = TRUE)
rsq(long_stay_fit_sur, adj = TRUE)
rsq(long_stay_fit_sat, adj = TRUE)
long_stay_fit_q<-  glm(formula = long_stay ~ age_at_nephrectomy +
gender +
body_mass_index +
surgery_type +
surgical_approach +
surgical_procedure +
clavien_surgical_complications +
estimated_blood_loss +
comorbidities__chronic_kidney_disease +
comorbidities__hemiplegia_from_stroke +
pathologic_size +
cytoreductive +
alcohol_use +
smoking_history +
malignant,
family = quasibinomial(link = 'logit'),
data = kidney_hosp2)
summary(long_stay_fit_q)
summary(long_stay_fit_ind)
confint(long_stay_fit_ind)
exp(coef(hosp_days_fit_ind))
exp(confint(hosp_days_fit_ind))
table(kidney_hosp$alcohol_use)
table(kidney_hosp$smoking_history)
table(kidney_hosp$surgical_approach)
table(kidney_hosp$surgical_procedure)
confint(long_stay_fit_ind)
exp(coef(long_stay_fit_ind))
exp(confint(long_stay_fit_ind))
exp(3.686)
summary(kidney_hosp$estimated_blood_loss)
hist(kidney_hosp$estimated_blood_loss)
30-21.8
install.packages("BvCategorical")
library(BvCategorical)
library(BvCategorical)
x<-c(1,2,3)
y<-c(5,6,8)
lm(y~x)
library(rpart)
trees
girthy<-trees$Girth>15
tree2<-cbind(girthy,trees)
tree2
rpart(girthy~Height+Volume, tree2)
treep<-rpart(girthy~Height+Volume, tree2)
plot.rpart(treep)
rpart::plotcp(treep)
install.packages("rpart.plot")
library(rpart.plot)
rpart.plot(treep)
volumey<-trees$Volume<37
cbind(girthy,volumey)
glm(girthy~height)
glm(girthy ~ height, data = tree2)
glm(girthy ~ Height, data = tree2)
glm(girthy ~ Height, data = tree2, family = binomial(link = 'logit'))
exp(coef(glm(girthy ~ Height, data = tree2, family = binomial(link = 'logit'))))
knitr::opts_chunk$set(echo = TRUE)
# Loading in packages
library(tidyverse)
library(forecast)
library(DescTools)
library(randtests)
library(astsa)
library(FitAR)
library(here)
# Loading in packages
library(tidyverse)
library(forecast)
library(DescTools)
library(randtests)
library(astsa)
library(FitAR)
library(here)
# Establishing workspace location
i_am("peak-bloom-prediction/analysis_dc.R")
# Loading datasets
dc <- read_csv(here("peak-bloom-prediction/data/washingtondc.csv"))
dc_cur <- dc %>%
filter(year >= 1980) %>% # we filter due to data being more current and available from Daymet
rename(Date = bloom_date)
dc_tmin<-read_csv(here("peak-bloom-prediction/data/statistics_tmin.csv"))
dc_tmax<-read_csv(here("peak-bloom-prediction/data/statistics_tmax.csv"))
# Data Refining
dc_temp<-left_join(dc_tmin,dc_tmax, by = 'dt')
dc_temp<-dc_temp[,c('dt','value_mean.x','value_mean.y')]
colnames(dc_temp)<-c('Date', 'Temp_Min', 'Temp_Max')
# Average Daily Temps and Date Info
dc_temp<-dc_temp %>%
mutate(Temp_Avg = 0.5*(Temp_Min+Temp_Max)) %>%
mutate(Year = substr(Date,1,4)) %>%
mutate(Month = substr(Date,6,7))
# Calculating GDD at 50F()
cel <- function(x) {
(x-32)*5/9
}
thresh<-cel(45)
dc_temp<-dc_temp %>%
mutate(Temp_DD = ifelse (Temp_Avg-thresh>0,Temp_Avg-thresh,0)) %>%
group_by(Year) %>%
mutate(GDD = cumsum(Temp_DD))
# Calculating Cold Degrees
thresh_chill<-cel(32)
dc_temp<-dc_temp %>%
mutate(Season = ifelse(Month == '01'|Month == '02'|Month == '03'|Month == '04'|Month == '12','Cold Season', 'Warm Season')) %>%
mutate(Chill_Group = paste(Season, Year, sep = " ")) %>%
mutate(Temp_CD = ifelse (thresh_chill-Temp_Avg>0,thresh_chill-Temp_Avg,0)) %>%
group_by(Chill_Group) %>%
mutate(CDD = cumsum(Temp_CD))
# Merging GDD with Bloom Dates
dc_data<-left_join(dc_cur,dc_temp, by = 'Date')
# Time series analysis
avgts<-ts(dc_temp$Temp_Avg ,frequency = 365, start=c(1980,1), end=c(2020,365))
ts.plot(avgts)
plot(decompose(avgts))
dc_data %>%
ggplot(aes(x=))
# Establishing workspace location
i_am("peak-bloom-prediction/analysis_dc.R")
# Loading datasets
dc <- read_csv(here("peak-bloom-prediction/data/washingtondc.csv"))
dc_cur <- dc %>%
filter(year >= 1980) %>% # we filter due to data being more current and available from Daymet
rename(Date = bloom_date)
dc_tmin<-read_csv(here("peak-bloom-prediction/data/statistics_tmin.csv"))
dc_tmax<-read_csv(here("peak-bloom-prediction/data/statistics_tmax.csv"))
# Data Refining
dc_temp<-left_join(dc_tmin,dc_tmax, by = 'dt')
dc_temp<-dc_temp[,c('dt','value_mean.x','value_mean.y')]
colnames(dc_temp)<-c('Date', 'Temp_Min', 'Temp_Max')
# Average Daily Temps and Date Info
dc_temp<-dc_temp %>%
mutate(Temp_Avg = 0.5*(Temp_Min+Temp_Max)) %>%
mutate(Year = substr(Date,1,4)) %>%
mutate(Month = substr(Date,6,7))
# Establishing workspace location
i_am("peak-bloom-prediction/analysis_dc.R")
setwd("C:/Users/Joshua Wright/Desktop/cherry_pred")
# Establishing workspace location
i_am("peak-bloom-prediction/analysis_dc.R")
# Loading datasets
dc <- read_csv(here("peak-bloom-prediction/data/washingtondc.csv"))
dc_cur <- dc %>%
filter(year >= 1980) %>% # we filter due to data being more current and available from Daymet
rename(Date = bloom_date)
dc_tmin<-read_csv(here("peak-bloom-prediction/data/statistics_tmin.csv"))
dc_tmax<-read_csv(here("peak-bloom-prediction/data/statistics_tmax.csv"))
# Data Refining
dc_temp<-left_join(dc_tmin,dc_tmax, by = 'dt')
dc_temp<-dc_temp[,c('dt','value_mean.x','value_mean.y')]
colnames(dc_temp)<-c('Date', 'Temp_Min', 'Temp_Max')
# Average Daily Temps and Date Info
dc_temp<-dc_temp %>%
mutate(Temp_Avg = 0.5*(Temp_Min+Temp_Max)) %>%
mutate(Year = substr(Date,1,4)) %>%
mutate(Month = substr(Date,6,7))
# Calculating GDD at 50F()
cel <- function(x) {
(x-32)*5/9
}
thresh<-cel(45)
dc_temp<-dc_temp %>%
mutate(Temp_DD = ifelse (Temp_Avg-thresh>0,Temp_Avg-thresh,0)) %>%
group_by(Year) %>%
mutate(GDD = cumsum(Temp_DD))
thresh_chill<-cel(32)
dc_temp<-dc_temp %>%
mutate(Season = ifelse(Month == '01'|Month == '02'|Month == '03'|Month == '04'|Month == '12','Cold Season', 'Warm Season')) %>%
mutate(Chill_Group = paste(Season, Year, sep = " ")) %>%
mutate(Temp_CD = ifelse (thresh_chill-Temp_Avg>0,thresh_chill-Temp_Avg,0)) %>%
group_by(Chill_Group) %>%
mutate(CDD = cumsum(Temp_CD))
dc_data<-left_join(dc_cur,dc_temp, by = 'Date')
avgts<-ts(dc_temp$Temp_Avg ,frequency = 365, start=c(1980,1), end=c(2020,365))
ts.plot(avgts)
plot(decompose(avgts))
View(dc_cur)
dc_data %>%
ggplot(aes(y=bloom_doy,x=year)) +
geom_line()
View(dc_data)
